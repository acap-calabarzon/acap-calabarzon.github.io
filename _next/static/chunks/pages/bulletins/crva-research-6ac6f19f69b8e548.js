(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5642],{13518:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/bulletins/crva-research",function(){return r(91392)}])},91392:function(e,n,r){"use strict";r.r(n);var t=r(34051),i=r.n(t),o=r(85893),a=r(67294),s=r(87357),c=r(15861),l=r(26447),d=r(50122),u=r(81458),f=r(86886),h=r(66242),p=r(44267),x=r(11057),v=r(98456),m=r(41664),w=r(62665),b=r(91379),g=r(47376),j=r(56693),Z=r(44634);function y(e,n,r,t,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void r(l)}s.done?n(c):Promise.resolve(c).then(t,i)}function k(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var o=e.apply(n,r);function a(e){y(o,t,i,a,s,"next",e)}function s(e){y(o,t,i,a,s,"throw",e)}a(void 0)}))}}var z=function(e){if(!e)return"";var n=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,n)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][n])},_="AIzaSyBn3ZNnNJAgAjHKWV3zgjZ-z_xoRff97BE";n.default=function(){var e=(0,a.useState)([]),n=e[0],r=e[1],t=(0,a.useState)(!0),y=t[0],S=t[1],E=(0,a.useState)(null),R=E[0],B=E[1];(0,a.useEffect)((function(){var e=function(){var e=k(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://www.googleapis.com/drive/v3/files?pageSize=1000&q='".concat(encodeURIComponent("1RsexMQaZT8sUiuxfQ3A6cauxoJLFErdN"),"'+in+parents&fields=files(id,name,mimeType,size,modifiedTime,webViewLink)&key=").concat(_));case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Failed to fetch files");case 6:return e.next=8,n.json();case 8:t=e.sent,r(t.files||[]),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error fetching Drive files:",e.t0);case 15:return e.prev=15,S(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var N=function(){var e=k(i().mark((function e(n){var r,t,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,B(n.id),e.next=4,fetch("https://www.googleapis.com/drive/v3/files/".concat(n.id,"?alt=media&key=").concat(_));case 4:if((r=e.sent).ok){e.next=7;break}throw new Error("Download failed");case 7:return e.next=9,r.blob();case 9:t=e.sent,o=URL.createObjectURL(t),(a=document.createElement("a")).href=o,a.download=n.name,a.click(),URL.revokeObjectURL(o),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),window.open(n.webViewLink,"_blank");case 21:return e.prev=21,B(null),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[0,18,21,24]])})));return function(n){return e.apply(this,arguments)}}();return(0,o.jsxs)(s.Z,{sx:{p:{xs:2,sm:4}},children:[(0,o.jsx)(c.Z,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"CRVA Research Publications"}),(0,o.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,o.jsx)(c.Z,{align:"left",color:"text.secondary",variant:"body2",children:"Welcome to the CRVA Research Publications page."}),(0,o.jsx)(d.Z,{component:m.default,href:"/bulletins",underline:"hover",color:"primary",sx:{fontWeight:500,fontSize:"0.9rem"},children:"\u2190 Back to Bulletins"})]}),y?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u.Z,{sx:{mb:2}}),(0,o.jsx)(c.Z,{color:"text.secondary",variant:"body2",children:"Loading files..."})]}):0===n.length?(0,o.jsx)(c.Z,{color:"text.secondary",variant:"body2",children:"No files found."}):(0,o.jsx)(f.ZP,{container:!0,spacing:2,children:n.map((function(e){return(0,o.jsx)(f.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,o.jsx)(h.Z,{variant:"outlined",sx:{borderRadius:2,boxShadow:"none",height:"100%",transition:"background 0.2s","&:hover":{bgcolor:"grey.50"}},children:(0,o.jsxs)(p.Z,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:[(0,o.jsxs)(l.Z,{direction:"row",alignItems:"center",spacing:1,children:[(n=e.mimeType,r=e.name,(null===n||void 0===n?void 0:n.includes("pdf"))?(0,o.jsx)(w.Z,{color:"error",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("presentation"))||(null===r||void 0===r?void 0:r.endsWith(".pptx"))?(0,o.jsx)(g.Z,{color:"warning",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("word"))||(null===r||void 0===r?void 0:r.endsWith(".docx"))?(0,o.jsx)(b.Z,{color:"primary",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("image"))||/\.(jpg|jpeg|png|gif|webp)$/i.test(r)?(0,o.jsx)(j.Z,{color:"success",fontSize:"small"}):(0,o.jsx)(Z.Z,{color:"action",fontSize:"small"})),(0,o.jsx)(c.Z,{variant:"subtitle2",fontWeight:600,noWrap:!0,title:e.name,children:e.name})]}),(0,o.jsxs)(c.Z,{variant:"caption",color:"text.secondary",display:"block",mb:1,children:[e.mimeType," ",e.size?"\u2022 ".concat(z(Number(e.size))):""]}),(0,o.jsxs)(l.Z,{direction:"row",spacing:1,children:[(0,o.jsx)(x.Z,{variant:"contained",color:"primary",size:"small",onClick:function(){return N(e)},disabled:R===e.id,startIcon:R===e.id?(0,o.jsx)(v.Z,{size:14,color:"inherit"}):null,sx:{textTransform:"none",fontSize:"0.75rem",py:.3,px:1.5,flexGrow:1},children:R===e.id?"Downloading...":"Download"}),(0,o.jsx)(x.Z,{variant:"outlined",color:"secondary",size:"small",href:e.webViewLink,target:"_blank",rel:"noopener noreferrer",sx:{textTransform:"none",fontSize:"0.75rem",py:.3,px:1.5,flexGrow:1},children:"View"})]})]})})},e.id);var n,r}))})]})}}},function(e){e.O(0,[5778,3200,3410,947,9774,2888,179],(function(){return n=13518,e(e.s=n);var n}));var n=e.O();_N_E=n}]);