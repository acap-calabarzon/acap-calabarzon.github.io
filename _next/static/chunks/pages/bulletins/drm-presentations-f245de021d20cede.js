(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4211],{64938:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=t(58372)},35893:function(e,n,t){"use strict";var r=t(49064);n.Z=r.Z},58372:function(e,n,t){"use strict";t.r(n),t.d(n,{capitalize:function(){return o.Z},createChainedFunction:function(){return i.Z},createSvgIcon:function(){return a.Z},debounce:function(){return c.Z},deprecatedPropType:function(){return s},isMuiElement:function(){return l.Z},ownerDocument:function(){return u.Z},ownerWindow:function(){return f.Z},requirePropFactory:function(){return d},setRef:function(){return p},unstable_ClassNameGenerator:function(){return b},unstable_useEnhancedEffect:function(){return h.Z},unstable_useId:function(){return m.Z},unsupportedProp:function(){return v},useControlled:function(){return x.Z},useEventCallback:function(){return y.Z},useForkRef:function(){return w.Z},useIsFocusVisible:function(){return g.Z}});var r=t(88076),o=t(98216),i=t(35893),a=t(88169),c=t(57144);var s=function(e,n){return()=>null},l=t(71579),u=t(8038),f=t(5340);t(87462);var d=function(e,n){return()=>null},p=t(7960).Z,h=t(58974),m=t(27909);var v=function(e,n,t,r,o){return null},x=t(49299),y=t(2068),w=t(51705),g=t(18791);const b={configure:e=>{console.warn(["MUI: `ClassNameGenerator` import from `@mui/material/utils` is outdated and might cause unexpected issues.","","You should use `import { unstable_ClassNameGenerator } from '@mui/material/className'` instead","","The detail of the issue: https://github.com/mui/material-ui/issues/30011#issuecomment-1024993401","","The updated documentation: https://mui.com/guides/classname-generator/"].join("\n")),r.Z.configure(e)}}},27909:function(e,n,t){"use strict";var r=t(57579);n.Z=r.Z},50836:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/bulletins/drm-presentations",function(){return t(51442)}])},48418:function(e,n,t){"use strict";function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function o(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i=[],a=!0,c=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(s){c=!0,o=s}finally{try{a||null==t.return||t.return()}finally{if(c)throw o}}return i}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.default=void 0;var i,a=(i=t(67294))&&i.__esModule?i:{default:i},c=t(76273),s=t(90387),l=t(57190);var u={};function f(e,n,t,r){if(e&&c.isLocalURL(n)){e.prefetch(n,t,r).catch((function(e){0}));var o=r&&"undefined"!==typeof r.locale?r.locale:e&&e.locale;u[n+"%"+t+(o?"%"+o:"")]=!0}}var d=function(e){var n,t=!1!==e.prefetch,r=s.useRouter(),i=a.default.useMemo((function(){var n=o(c.resolveHref(r,e.href,!0),2),t=n[0],i=n[1];return{href:t,as:e.as?c.resolveHref(r,e.as):i||t}}),[r,e.href,e.as]),d=i.href,p=i.as,h=e.children,m=e.replace,v=e.shallow,x=e.scroll,y=e.locale;"string"===typeof h&&(h=a.default.createElement("a",null,h));var w=(n=a.default.Children.only(h))&&"object"===typeof n&&n.ref,g=o(l.useIntersection({rootMargin:"200px"}),2),b=g[0],Z=g[1],j=a.default.useCallback((function(e){b(e),w&&("function"===typeof w?w(e):"object"===typeof w&&(w.current=e))}),[w,b]);a.default.useEffect((function(){var e=Z&&t&&c.isLocalURL(d),n="undefined"!==typeof y?y:r&&r.locale,o=u[d+"%"+p+(n?"%"+n:"")];e&&!o&&f(r,d,p,{locale:n})}),[p,d,Z,y,t,r]);var k={ref:j,onClick:function(e){n.props&&"function"===typeof n.props.onClick&&n.props.onClick(e),e.defaultPrevented||function(e,n,t,r,o,i,a,s){("A"!==e.currentTarget.nodeName.toUpperCase()||!function(e){var n=e.currentTarget.target;return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&c.isLocalURL(t))&&(e.preventDefault(),n[o?"replace":"push"](t,r,{shallow:i,locale:s,scroll:a}))}(e,r,d,p,m,v,x,y)},onMouseEnter:function(e){n.props&&"function"===typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),c.isLocalURL(d)&&f(r,d,p,{priority:!0})}};if(e.passHref||"a"===n.type&&!("href"in n.props)){var _="undefined"!==typeof y?y:r&&r.locale,E=r&&r.isLocaleDomain&&c.getDomainLocale(p,_,r&&r.locales,r&&r.domainLocales);k.href=E||c.addBasePath(c.addLocale(p,_,r&&r.defaultLocale))}return a.default.cloneElement(n,k)};n.default=d},51442:function(e,n,t){"use strict";t.r(n);var r=t(34051),o=t.n(r),i=t(85893),a=t(67294),c=t(87357),s=t(15861),l=t(26447),u=t(50122),f=t(61903),d=t(87109),p=t(81458),h=t(86886),m=t(66242),v=t(44267),x=t(11057),y=t(98456),w=t(42761),g=t(41664),b=t(62665),Z=t(91379),j=t(47376),k=t(56693),_=t(44634);function E(e,n,t,r,o,i,a){try{var c=e[i](a),s=c.value}catch(l){return void t(l)}c.done?n(s):Promise.resolve(s).then(r,o)}function S(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){E(i,r,o,a,c,"next",e)}function c(e){E(i,r,o,a,c,"throw",e)}a(void 0)}))}}var L=function(e){if(!e)return"";var n=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,n)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][n])},C="AIzaSyBn3ZNnNJAgAjHKWV3zgjZ-z_xoRff97BE";n.default=function(){var e=(0,a.useState)([]),n=e[0],t=e[1],r=(0,a.useState)(!0),E=r[0],z=r[1],M=(0,a.useState)(null),R=M[0],I=M[1],P=(0,a.useState)(""),T=P[0],N=P[1];(0,a.useEffect)((function(){var e=function(){var e=S(o().mark((function e(){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://www.googleapis.com/drive/v3/files?pageSize=1000&q='".concat(encodeURIComponent("1I61cBsxyM0iwgi-REFEV0SU6qw1cnqhy"),"'+in+parents&fields=files(id,name,mimeType,size,modifiedTime,webViewLink)&key=").concat(C));case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Failed to fetch files");case 6:return e.next=8,n.json();case 8:r=e.sent,t(r.files||[]),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error fetching Drive files:",e.t0);case 15:return e.prev=15,z(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var U=function(){var e=S(o().mark((function e(n){var t,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I(n.id),e.next=4,fetch("https://www.googleapis.com/drive/v3/files/".concat(n.id,"?alt=media&key=").concat(C));case 4:if((t=e.sent).ok){e.next=7;break}throw new Error("Download failed");case 7:return e.next=9,t.blob();case 9:r=e.sent,i=URL.createObjectURL(r),(a=document.createElement("a")).href=i,a.download=n.name,a.click(),URL.revokeObjectURL(i),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),window.open(n.webViewLink,"_blank");case 21:return e.prev=21,I(null),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[0,18,21,24]])})));return function(n){return e.apply(this,arguments)}}(),B=n.filter((function(e){return e.name.toLowerCase().includes(T.toLowerCase())}));return(0,i.jsxs)(c.Z,{sx:{p:{xs:2,sm:4}},children:[(0,i.jsx)(s.Z,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"DRM Presentations"}),(0,i.jsxs)(l.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,i.jsx)(s.Z,{align:"left",color:"text.secondary",variant:"body2",children:"Files loaded from the DRM Google Drive folder."}),(0,i.jsx)(u.Z,{component:g.default,href:"/bulletins",underline:"hover",color:"primary",sx:{fontWeight:500,fontSize:"0.9rem"},children:"\u2190 Back to Bulletins"})]}),(0,i.jsx)(f.Z,{fullWidth:!0,placeholder:"Search files...",variant:"outlined",size:"small",value:T,onChange:function(e){return N(e.target.value)},sx:{mb:3,maxWidth:400},InputProps:{startAdornment:(0,i.jsx)(d.Z,{position:"start",children:(0,i.jsx)(w.Z,{color:"action"})})}}),E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{sx:{mb:2}}),(0,i.jsx)(s.Z,{color:"text.secondary",variant:"body2",children:"Loading files..."})]}):0===B.length?(0,i.jsxs)(s.Z,{color:"text.secondary",variant:"body2",children:["No files found ",T?'for "'.concat(T,'"'):"","."]}):(0,i.jsx)(h.ZP,{container:!0,spacing:2,children:B.map((function(e){return(0,i.jsx)(h.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,i.jsx)(m.Z,{variant:"outlined",sx:{borderRadius:2,boxShadow:"none",height:"100%",transition:"background 0.2s","&:hover":{bgcolor:"grey.50"}},children:(0,i.jsxs)(v.Z,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:[(0,i.jsxs)(l.Z,{direction:"row",alignItems:"center",spacing:1,children:[(n=e.mimeType,t=e.name,(null===n||void 0===n?void 0:n.includes("pdf"))?(0,i.jsx)(b.Z,{color:"error",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("presentation"))||(null===t||void 0===t?void 0:t.endsWith(".pptx"))?(0,i.jsx)(j.Z,{color:"warning",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("word"))||(null===t||void 0===t?void 0:t.endsWith(".docx"))?(0,i.jsx)(Z.Z,{color:"primary",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("image"))||/\.(jpg|jpeg|png|gif|webp)$/i.test(t)?(0,i.jsx)(k.Z,{color:"success",fontSize:"small"}):(0,i.jsx)(_.Z,{color:"action",fontSize:"small"})),(0,i.jsx)(s.Z,{variant:"subtitle2",fontWeight:600,noWrap:!0,title:e.name,children:e.name})]}),(0,i.jsxs)(s.Z,{variant:"caption",color:"text.secondary",display:"block",mb:1,children:[e.mimeType," ",e.size?"\u2022 ".concat(L(Number(e.size))):""]}),(0,i.jsxs)(l.Z,{direction:"row",spacing:1,children:[(0,i.jsx)(x.Z,{variant:"contained",color:"primary",size:"small",onClick:function(){return U(e)},disabled:R===e.id,startIcon:R===e.id?(0,i.jsx)(y.Z,{size:14,color:"inherit"}):null,sx:{textTransform:"none",fontSize:"0.75rem",py:.3,px:1.5,flexGrow:1},children:R===e.id?"Downloading...":"Download"}),(0,i.jsx)(x.Z,{variant:"outlined",color:"secondary",size:"small",href:e.webViewLink,target:"_blank",rel:"noopener noreferrer",sx:{textTransform:"none",fontSize:"0.75rem",py:.3,px:1.5,flexGrow:1},children:"View"})]})]})})},e.id);var n,t}))})]})}},41664:function(e,n,t){e.exports=t(48418)},64836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}},function(e){e.O(0,[5778,3593,9964,8858,6223,3410,9181,9774,2888,179],(function(){return n=50836,e(e.s=n);var n}));var n=e.O();_N_E=n}]);