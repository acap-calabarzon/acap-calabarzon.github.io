(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5642],{64938:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=t(58372)},35893:function(e,n,t){"use strict";var r=t(49064);n.Z=r.Z},58372:function(e,n,t){"use strict";t.r(n),t.d(n,{capitalize:function(){return o.Z},createChainedFunction:function(){return i.Z},createSvgIcon:function(){return a.Z},debounce:function(){return u.Z},deprecatedPropType:function(){return c},isMuiElement:function(){return s.Z},ownerDocument:function(){return l.Z},ownerWindow:function(){return f.Z},requirePropFactory:function(){return d},setRef:function(){return p},unstable_ClassNameGenerator:function(){return g},unstable_useEnhancedEffect:function(){return h.Z},unstable_useId:function(){return m.Z},unsupportedProp:function(){return v},useControlled:function(){return x.Z},useEventCallback:function(){return y.Z},useForkRef:function(){return w.Z},useIsFocusVisible:function(){return b.Z}});var r=t(88076),o=t(98216),i=t(35893),a=t(88169),u=t(57144);var c=function(e,n){return()=>null},s=t(71579),l=t(8038),f=t(5340);t(87462);var d=function(e,n){return()=>null},p=t(7960).Z,h=t(58974),m=t(27909);var v=function(e,n,t,r,o){return null},x=t(49299),y=t(2068),w=t(51705),b=t(18791);const g={configure:e=>{console.warn(["MUI: `ClassNameGenerator` import from `@mui/material/utils` is outdated and might cause unexpected issues.","","You should use `import { unstable_ClassNameGenerator } from '@mui/material/className'` instead","","The detail of the issue: https://github.com/mui/material-ui/issues/30011#issuecomment-1024993401","","The updated documentation: https://mui.com/guides/classname-generator/"].join("\n")),r.Z.configure(e)}}},27909:function(e,n,t){"use strict";var r=t(57579);n.Z=r.Z},49064:function(e,n,t){"use strict";function r(...e){return e.reduce(((e,n)=>null==n?e:function(...t){e.apply(this,t),n.apply(this,t)}),(()=>{}))}t.d(n,{Z:function(){return r}})},57094:function(e,n,t){"use strict";function r(e){return e&&e.ownerDocument||document}t.d(n,{Z:function(){return r}})},58290:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(57094);function o(e){return(0,r.Z)(e).defaultView||window}},57579:function(e,n,t){"use strict";var r;t.d(n,{Z:function(){return u}});var o=t(67294);let i=0;const a=(r||(r=t.t(o,2))).useId;function u(e){if(void 0!==a){const n=a();return null!=e?e:n}return function(e){const[n,t]=o.useState(e),r=e||n;return o.useEffect((()=>{null==n&&(i+=1,t(`mui-${i}`))}),[n]),r}(e)}},13518:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/bulletins/crva-research",function(){return t(91392)}])},48418:function(e,n,t){"use strict";function r(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function o(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i=[],a=!0,u=!1;try{for(t=t.call(e);!(a=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);a=!0);}catch(c){u=!0,o=c}finally{try{a||null==t.return||t.return()}finally{if(u)throw o}}return i}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return r(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return r(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.default=void 0;var i,a=(i=t(67294))&&i.__esModule?i:{default:i},u=t(76273),c=t(90387),s=t(57190);var l={};function f(e,n,t,r){if(e&&u.isLocalURL(n)){e.prefetch(n,t,r).catch((function(e){0}));var o=r&&"undefined"!==typeof r.locale?r.locale:e&&e.locale;l[n+"%"+t+(o?"%"+o:"")]=!0}}var d=function(e){var n,t=!1!==e.prefetch,r=c.useRouter(),i=a.default.useMemo((function(){var n=o(u.resolveHref(r,e.href,!0),2),t=n[0],i=n[1];return{href:t,as:e.as?u.resolveHref(r,e.as):i||t}}),[r,e.href,e.as]),d=i.href,p=i.as,h=e.children,m=e.replace,v=e.shallow,x=e.scroll,y=e.locale;"string"===typeof h&&(h=a.default.createElement("a",null,h));var w=(n=a.default.Children.only(h))&&"object"===typeof n&&n.ref,b=o(s.useIntersection({rootMargin:"200px"}),2),g=b[0],Z=b[1],j=a.default.useCallback((function(e){g(e),w&&("function"===typeof w?w(e):"object"===typeof w&&(w.current=e))}),[w,g]);a.default.useEffect((function(){var e=Z&&t&&u.isLocalURL(d),n="undefined"!==typeof y?y:r&&r.locale,o=l[d+"%"+p+(n?"%"+n:"")];e&&!o&&f(r,d,p,{locale:n})}),[p,d,Z,y,t,r]);var k={ref:j,onClick:function(e){n.props&&"function"===typeof n.props.onClick&&n.props.onClick(e),e.defaultPrevented||function(e,n,t,r,o,i,a,c){("A"!==e.currentTarget.nodeName.toUpperCase()||!function(e){var n=e.currentTarget.target;return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&u.isLocalURL(t))&&(e.preventDefault(),n[o?"replace":"push"](t,r,{shallow:i,locale:c,scroll:a}))}(e,r,d,p,m,v,x,y)},onMouseEnter:function(e){n.props&&"function"===typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),u.isLocalURL(d)&&f(r,d,p,{priority:!0})}};if(e.passHref||"a"===n.type&&!("href"in n.props)){var _="undefined"!==typeof y?y:r&&r.locale,E=r&&r.isLocaleDomain&&u.getDomainLocale(p,_,r&&r.locales,r&&r.domainLocales);k.href=E||u.addBasePath(u.addLocale(p,_,r&&r.defaultLocale))}return a.default.cloneElement(n,k)};n.default=d},91392:function(e,n,t){"use strict";t.r(n);var r=t(34051),o=t.n(r),i=t(85893),a=t(67294),u=t(87357),c=t(15861),s=t(26447),l=t(50122),f=t(81458),d=t(86886),p=t(66242),h=t(44267),m=t(11057),v=t(98456),x=t(41664),y=t(62665),w=t(91379),b=t(47376),g=t(56693),Z=t(44634);function j(e,n,t,r,o,i,a){try{var u=e[i](a),c=u.value}catch(s){return void t(s)}u.done?n(c):Promise.resolve(c).then(r,o)}function k(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var i=e.apply(n,t);function a(e){j(i,r,o,a,u,"next",e)}function u(e){j(i,r,o,a,u,"throw",e)}a(void 0)}))}}var _=function(e){if(!e)return"";var n=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,n)).toFixed(1)," ").concat(["B","KB","MB","GB","TB"][n])},E="AIzaSyBn3ZNnNJAgAjHKWV3zgjZ-z_xoRff97BE";n.default=function(){var e=(0,a.useState)([]),n=e[0],t=e[1],r=(0,a.useState)(!0),j=r[0],L=r[1],S=(0,a.useState)(null),C=S[0],z=S[1];(0,a.useEffect)((function(){var e=function(){var e=k(o().mark((function e(){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://www.googleapis.com/drive/v3/files?pageSize=1000&q='".concat(encodeURIComponent("1RsexMQaZT8sUiuxfQ3A6cauxoJLFErdN"),"'+in+parents&fields=files(id,name,mimeType,size,modifiedTime,webViewLink)&key=").concat(E));case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Failed to fetch files");case 6:return e.next=8,n.json();case 8:r=e.sent,t(r.files||[]),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Error fetching Drive files:",e.t0);case 15:return e.prev=15,L(!1),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var R=function(){var e=k(o().mark((function e(n){var t,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,z(n.id),e.next=4,fetch("https://www.googleapis.com/drive/v3/files/".concat(n.id,"?alt=media&key=").concat(E));case 4:if((t=e.sent).ok){e.next=7;break}throw new Error("Download failed");case 7:return e.next=9,t.blob();case 9:r=e.sent,i=URL.createObjectURL(r),(a=document.createElement("a")).href=i,a.download=n.name,a.click(),URL.revokeObjectURL(i),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),window.open(n.webViewLink,"_blank");case 21:return e.prev=21,z(null),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[0,18,21,24]])})));return function(n){return e.apply(this,arguments)}}();return(0,i.jsxs)(u.Z,{sx:{p:{xs:2,sm:4}},children:[(0,i.jsx)(c.Z,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"CRVA Research Publications"}),(0,i.jsxs)(s.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:2,children:[(0,i.jsx)(c.Z,{align:"left",color:"text.secondary",variant:"body2",children:"Welcome to the CRVA Research Publications page."}),(0,i.jsx)(l.Z,{component:x.default,href:"/bulletins",underline:"hover",color:"primary",sx:{fontWeight:500,fontSize:"0.9rem"},children:"\u2190 Back to Bulletins"})]}),j?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{sx:{mb:2}}),(0,i.jsx)(c.Z,{color:"text.secondary",variant:"body2",children:"Loading files..."})]}):0===n.length?(0,i.jsx)(c.Z,{color:"text.secondary",variant:"body2",children:"No files found."}):(0,i.jsx)(d.ZP,{container:!0,spacing:2,children:n.map((function(e){return(0,i.jsx)(d.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,i.jsx)(p.Z,{variant:"outlined",sx:{borderRadius:2,boxShadow:"none",height:"100%",transition:"background 0.2s","&:hover":{bgcolor:"grey.50"}},children:(0,i.jsxs)(h.Z,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:[(0,i.jsxs)(s.Z,{direction:"row",alignItems:"center",spacing:1,children:[(n=e.mimeType,t=e.name,(null===n||void 0===n?void 0:n.includes("pdf"))?(0,i.jsx)(y.Z,{color:"error",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("presentation"))||(null===t||void 0===t?void 0:t.endsWith(".pptx"))?(0,i.jsx)(b.Z,{color:"warning",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("word"))||(null===t||void 0===t?void 0:t.endsWith(".docx"))?(0,i.jsx)(w.Z,{color:"primary",fontSize:"small"}):(null===n||void 0===n?void 0:n.includes("image"))||/\.(jpg|jpeg|png|gif|webp)$/i.test(t)?(0,i.jsx)(g.Z,{color:"success",fontSize:"small"}):(0,i.jsx)(Z.Z,{color:"action",fontSize:"small"})),(0,i.jsx)(c.Z,{variant:"subtitle2",fontWeight:600,noWrap:!0,title:e.name,children:e.name})]}),(0,i.jsxs)(c.Z,{variant:"caption",color:"text.secondary",display:"block",mb:1,children:[e.mimeType," ",e.size?"\u2022 ".concat(_(Number(e.size))):""]}),(0,i.jsxs)(s.Z,{direction:"row",spacing:1,children:[(0,i.jsx)(m.Z,{variant:"contained",color:"primary",size:"small",onClick:function(){return R(e)},disabled:C===e.id,startIcon:C===e.id?(0,i.jsx)(v.Z,{size:14,color:"inherit"}):null,sx:{textTransform:"none",fontSize:"0.75rem",py:.3,px:1.5,flexGrow:1},children:C===e.id?"Downloading...":"Download"}),(0,i.jsx)(m.Z,{variant:"outlined",color:"secondary",size:"small",href:e.webViewLink,target:"_blank",rel:"noopener noreferrer",sx:{textTransform:"none",fontSize:"0.75rem",py:.3,px:1.5,flexGrow:1},children:"View"})]})]})})},e.id);var n,t}))})]})}},41664:function(e,n,t){e.exports=t(48418)},64836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}},function(e){e.O(0,[5778,3200,3410,173,9774,2888,179],(function(){return n=13518,e(e.s=n);var n}));var n=e.O();_N_E=n}]);